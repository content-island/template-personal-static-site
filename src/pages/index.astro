---
import Layout from '#layouts/layout.astro';
import PostCollection from '#pods/post-collection/post-collection.pod.astro';
import MiniBioPod from '#pods/mini-bio/mini-bio.pod.astro';
import PopularPostsPod from '#pods/popular-post/popular-post.pod.astro';
import { getAllPosts } from '#pods/post-collection/api';
import HomeHeroPod from '#pods/home-hero/home-hero.pod.astro';
import MonthlyRecommendationPod from '#pods/monthly-recommendation/monthly-recommendation.pod.astro';

const allPosts = await getAllPosts();
const sortedPosts = allPosts.sort((a: any, b: any) => new Date(b.date).getTime() - new Date(a.date).getTime());

const otherPosts = allPosts.slice(0, 5);
---

<Layout title="John's Web Dev Blog">
  <HomeHeroPod slot="hero" />

  <PostCollection posts={sortedPosts} />

  <Fragment slot="aside">
    <MiniBioPod type="card" />
    <MonthlyRecommendationPod />
    <PopularPostsPod otherPosts={otherPosts} />
  </Fragment>
</Layout>
